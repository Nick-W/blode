<html>
    <head>
        <title>test.</title>
        <script src="prototype.js" type="text/javascript"></script>
        <script src="scriptaculous.js?load=effects" type="text/javascript"></script>
        <style type="text/css">
            body {
                background-color: #eee;
                margin: 0;
                padding: 0;
            }

            ul {
                padding: 0;
                margin: 0;
            }

            ul#messages ul {
                border-bottom: solid 1px #ddd;
            }

            ul#messages ul li {
                display: inline-block;
                padding: 5px 10px;
            }
        </style>
    </head>

    <body>
        <ul id="messages">
        </ul>
        
        <script language="javascript">
            document.observe("dom:loaded", function() {
                var last_id = 0;

                window.setInterval(function() {
                    new Ajax.Request('/proxy', {
                        onComplete: function(transport) {
                            var log = transport.responseJSON;
                            if(log.id > last_id) {
                                last_id = log.id;
                                $('messages').insert("<ul><li>" + log.severity + "</li><li>" + log.message + "</li></ul>");
                            }
                        }
                    });
                }, 500);
            });

        </script>
    </body>
</html>
